{\rtf1\adeflang1037\ansi\ansicpg1255\uc1\adeff15 \deff0\deflang1033\deflangfe1037{\fonttbl{\f0\froman\fcharset0\fprq2{\*\panose 02020603050405020304}Times New Roman;}{\f14\fnil\fcharset2\fprq2{\*\panose 05000000000000000000}Wingdings;}{\f15\fbidi \fcharset177\fprq2{\*\panose 00000000000000000000}Miriam;}{\f66\froman\fcharset238\fprq2 Times New Roman CE;}{\f67\froman\fcharset204\fprq2 Times New Roman Cyr;}{\f69\froman\fcharset161\fprq2 Times New Roman Greek;}{\f70\froman\fcharset162\fprq2 Times New Roman Tur;}{\f71\fbidi \fcharset177\fprq2 Times New Roman (Hebrew);}{\f73\froman\fcharset186\fprq2 Times New Roman Baltic;}{\f183\fbidi \fcharset177\fprq2 Wingdings (Hebrew);}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\nowidctlpar\widctlpar\adjustright \rtlpar \qr\rtlch\af15\afs20 \ltrch\fs20 \snext0 Normal;}{\s1\qc\keepn\nowidctlpar\widctlpar\adjustright \qc\rtlch\af15\afs20 \ltrch\fs32 \sbasedon0 \snext0 heading 1;}{\s2\qc\keepn\nowidctlpar\widctlpar\adjustright \qc\rtlch\af15\afs20 \ltrch\fs24 \sbasedon0 \snext0 heading 2;}{\s3\ql\keepn\nowidctlpar\widctlpar\adjustright \ql\rtlch\ab\af15\afs20\aul \ltrch\b\fs24\ul \sbasedon0 \snext0 heading 3;}{\s4\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\adjustright \ql\rtlch\af15\afs20\expnd-6\expndtw-30 \ltrch\fs24\expnd-6\expndtw-30 \sbasedon0 \snext0 heading 4;}{\s5\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\adjustright \ql\rtlch\ab\af15\afs20 \ltrch\b\fs24 \sbasedon0 \snext0 heading 5;}{\s6\qc\keepn\nowidctlpar\widctlpar\adjustright \qc\rtlch\af15\afs28 \ltrch\fs24 \sbasedon0 \snext0 heading 6;}{\s7\qc\sl360\slmult1\keepn\nowidctlpar\widctlpar\adjustright \qc\rtlch\ab\af15\afs20 \ltrch\b\fs24 \sbasedon0 \snext0 heading 7;}{\s8\ql\li720\sl360\slmult1\keepn\nowidctlpar\widctlpar\adjustright \ql\rtlch\af15\afs20 \ltrch\fs24 \sbasedon0 \snext0 heading 8;}{\*\cs10 \additive Default Paragraph Font;}{\s15\qc\nowidctlpar\widctlpar\adjustright \qc\rtlch\af15\afs20 \ltrch\fs28 \sbasedon0 \snext15 Title;}}{\*\listtable{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid119344630}{\list\listtemplateid67960837\listsimple{\listlevel\levelnfc25\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'01\u-3929 ?;}{\levelnumbers;}\f14\fbias0 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid212888909}{\list\listtemplateid1908183542\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid219753647}{\list\listtemplateid-398961648\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid289753762}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid418139455}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid510993034}{\list\listtemplateid67960837\listsimple{\listlevel\levelnfc25\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'01\u-3929 ?;}{\levelnumbers;}\f14\fbias0 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid522594658}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid869955900}{\list\listtemplateid-336435310\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext
\'02\'00.;}{\levelnumbers\'01;}\ltrch \fs24 \rtlch \f15\fs24 \fi-283\li340\jclisttab\tx417 }{\listname ;}\listid914512848}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid996030573}{\list\listtemplateid-1300836084\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-340\li567\jclisttab\tx587 }{\listname ;}\listid1000542890}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid1029718684}{\list\listtemplateid1860233692\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-279\li567\jclisttab\tx648 }{\listname ;}\listid1103526621}{\list\listtemplateid-1300836084\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-340\li567\jclisttab\tx587 }{\listname ;}\listid1115101852}{\list\listtemplateid67960837\listsimple{\listlevel\levelnfc25\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'01\u-3929 ?;}{\levelnumbers;}\f14\fbias0 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid1242564137}{\list\listtemplateid-1103093012\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid1729765135}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext
\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid1759906743}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid1812332836}{\list\listtemplateid1908183542\listsimple{\listlevel\levelnfc6\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-72\li360\jclisttab\tx648 }{\listname ;}\listid1872183915}{\list\listtemplateid734668994\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \strike0\shad0\embo0\impr0\caps0\v0\cf0\nosupersub\striked0 \rtlch \strike0\shad0\embo0\impr0\caps0\v0\f15\cf0\nosupersub\striked0 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid1947687293}{\list\listtemplateid-1103093012\listsimple{\listlevel\levelnfc0\leveljc1\levelfollow0\levelstartat1\levelspace0\levelindent0{\leveltext\'02\'00.;}{\levelnumbers\'01;}\ltrch \rtlch \f15 \fi-284\li454\jclisttab\tx530 }{\listname ;}\listid2026710088}}{\*\listoverridetable{\listoverride\listid1729765135\listoverridecount0\ls1}{\listoverride\listid522594658\listoverridecount0\ls2}{\listoverride\listid1242564137\listoverridecount0\ls3}{\listoverride\listid2026710088\listoverridecount0\ls4}{\listoverride\listid119344630\listoverridecount0\ls5}{\listoverride\listid212888909\listoverridecount0\ls6}{\listoverride\listid1947687293\listoverridecount0\ls7}{\listoverride\listid1812332836\listoverridecount0\ls8}{\listoverride\listid1759906743\listoverridecount0\ls9}{\listoverride\listid418139455\listoverridecount0\ls10}{\listoverride\listid1029718684\listoverridecount0\ls11}{\listoverride\listid510993034\listoverridecount0\ls12}{\listoverride\listid869955900\listoverridecount0\ls13}{\listoverride\listid996030573\listoverridecount0\ls14}{\listoverride\listid914512848\listoverridecount0\ls15}{\listoverride\listid1872183915\listoverridecount0\ls16}{\listoverride\listid219753647\listoverridecount0\ls17}{\listoverride\listid1115101852\listoverridecount0\ls18}{\listoverride\listid1000542890\listoverridecount0\ls19}{\listoverride\listid289753762\listoverridecount0\ls20}{\listoverride\listid1103526621\listoverridecount0\ls21}}{\info{\title The DataBase Course}{\author γεγ θμαι}{\operator γεγ θμαι}{\creatim\yr1997\mo12\dy25\min15}{\revtim\yr1997\mo12\dy25\min15}{\printim\yr1997\mo12\dy25\min8}{\version2}{\edmins0}{\nofpages3}{\nofwords629}{\nofchars3589}{\*\company  }{\nofcharsws4407}{\vern81}}\paperw11906\paperh16838\rtlsect \widowctrl\ftnbj\aenddoc\formshade\viewkind1\viewscale100\pgbrdrhead\pgbrdrfoot \fet0\ltrpar \qc\sectd \rtlsect\linex0\headery709\footery709\colsx709\endnhere\sectdefaultcl {\*\pnseclvl1\pnucrm\pnqc\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnqc\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnqc\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnqc\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnqc\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnqc\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnqc\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnqc\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnqc\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \ltrpar\qc\s15\qc\sl480\slmult1\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs28 {\rtlch \af15 \ltrch The Databases Course
\par }\pard\plain \ltrpar\qc\s1\qc\sl480\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel0\adjustright \rtlch\af15\afs20 \ltrch\fs32 {\rtlch \af15 \ltrch Solution of Exercise No. 5
\par }\pard\plain \ltrpar\qc\s6\qc\keepn\nowidctlpar\widctlpar\outlinelevel5\adjustright \rtlch\af15\afs28 \ltrch\fs24 {\rtlch \af15 \ltrch More SQL - Practical
\par }\pard\plain \ltrpar\ql\ql\sl360\slmult1\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs20 {\rtlch \af15 \ltrch 
\par }\pard\plain \ltrpar\ql\s3\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel2\adjustright \rtlch\ab\af15\afs20\aul \ltrch\b\fs24\ul {\rtlch \af15 \ltrch 
\par }\pard\plain \ltrpar\ql\s4\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel3\adjustright \rtlch\af15\afs20\expnd-6\expndtw-30 \ltrch\fs24\expnd-6\expndtw-30 {\rtlch \ab\af15\aul\expnd0\expndtw0 \ltrch \b\ul\expnd0\expndtw0 Question 1
\par }\pard\plain \rtlpar\qr\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs20 {\rtlch \af15 \ltrch 
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'61\'2e\tab}}\pard \ltrpar\ql\ql\fi-72\li72\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx360{\*\pn \pnlvlbody\ilvl0\ls20\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls20\adjustright {\rtlch \af15 \ltrch \fs24 select p#\line          from shipments\line          group by p#\line          having count(distinct s#) > count(distinct j#);
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'62\'2e\tab}}\pard \ltrpar\ql\ql\fi-72\li72\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx360{\*\pn \pnlvlbody\ilvl0\ls20\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls20\adjustright {\rtlch \af15 \ltrch \fs24 select h.s#, h.p#, sum(p.weight)\line          from shipments h, p}{\rtlch \af15 \ltrch \fs24 arts p, suppliers s\line          where h.p# = p.p# and h.s# = s.s# and s.city = 'London'\line          group by h.s#, h.p#\line          having sum(p.weight) > (select 2*avg(weight) from parts);\line     As usual, other }{\rtlch \af15\aul \ltrch \fs24\ul documented}{\rtlch \af15 \ltrch \fs24  definitions of an average are also acceptabl}{\rtlch \af15 \ltrch \fs24 e.
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'63\'2e\tab}}\pard \ltrpar\ql\ql\fi-72\li72\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx360{\*\pn \pnlvlbody\ilvl0\ls20\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls20\adjustright {\rtlch \af15 \ltrch \fs24 select count(*) / (count (distinct j.j#) * count(distinct j.j#) )\line          from shipments s, projects j;\line     This solution doesn\rquote t use \lquote group by\rquote  and gives a two points bonus. Note that it\line     considers the possibility of projects with no parts, multipl}{\rtlch \af15 \ltrch \fs24 e shipments of the same\line     part to a project, and so on.
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'64\'2e\tab}}\pard \ltrpar\ql\ql\fi-72\li72\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx360{\*\pn \pnlvlbody\ilvl0\ls20\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls20\adjustright {\rtlch \af15 \ltrch \fs24 select distinct h1.s#\line          from shipments h1\line          where not exists ( select distinct h2.s#, p.p#, j.j#\line                                            from shipments h2, parts p, projects j\line      }{\rtlch \af15 \ltrch \fs24                                       where h1.s#=h2.s# and p.p# in ('p1', 'p2', 'p3', 'p5')\line                                       minus\line                                       select * from shipments);
\par }\pard \ltrpar\ql\ql\li57\sl360\slmult1\nowidctlpar\widctlpar\adjustright {\rtlch \af15 \ltrch \fs24 
\par }\pard\plain \ltrpar\ql\s4\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel3\adjustright \rtlch\af15\afs20\expnd-6\expndtw-30 \ltrch\fs24\expnd-6\expndtw-30 {\rtlch \ab\af15\aul\expnd0\expndtw0 \ltrch \b\ul\expnd0\expndtw0 
\par }\pard\plain \rtlpar\qr\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs20 {\rtlch \af15 \ltrch 
\par }\pard\plain \ltrpar\ql\s4\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel3\adjustright \rtlch\af15\afs20\expnd-6\expndtw-30 \ltrch\fs24\expnd-6\expndtw-30 {\rtlch \ab\af15\aul\expnd0\expndtw0 \ltrch \b\ul\expnd0\expndtw0 Question 2
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 create table friends 
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      ( firstname v}{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 archar2(20),
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0         lastname varchar2(20),
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0         birthday date,
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0         height numeric(4,2),
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0         occupation varchar2(20) );
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 insert 
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      into friends (firstname, lastname, birthday, height, occupation)
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      values ('Snow', 'White', '1-may-69', 1.75,}{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0  'Princess');
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 /* Insert nine more friends here using the same syntax. At least one student! */
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 select *\line      from friends
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      order by height desc;
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 update friends
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      set (height) = 2
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      where height > (select avg(height) from friends);
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 delete
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      fro}{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 m friends
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      where occupation = 'Student';
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 select * 
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      from friends
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0      order by lastname, firstname;
\par }{\rtlch \af15\expnd0\expndtw0 \ltrch \expnd0\expndtw0 drop table friends;
\par }\pard\plain \rtlpar\ql\ql\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs20 {\ltrch \afs24 \rtlch \f15 
\par }{\ltrch \afs24 \rtlch \f15 
\par }{\rtlch \af15 \ltrch \fs24 
\par }\pard\plain \ltrpar\ql\s4\ql\sl360\slmult1\keepn\nowidctlpar\widctlpar\outlinelevel3\adjustright \rtlch\af15\afs20\expnd-6\expndtw-30 \ltrch\fs24\expnd-6\expndtw-30 {\rtlch \ab\af15\aul\expnd0\expndtw0 \ltrch \b\ul\expnd0\expndtw0 Question 3
\par }\pard\plain \ltrpar\ql\ql\nowidctlpar\widctlpar\adjustright \rtlch\af15\afs20 \ltrch\fs20 {\rtlch \af15 \ltrch \fs24 
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'61\'2e\tab}}\pard \ltrpar\ql\ql\fi-74\li363\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx648{\*\pn \pnlvlbody\ilvl0\ls21\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls21\adjustright {\rtlch \af15 \ltrch \fs24 select distinct a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24 , …, a}{\rtlch \af15\sub \ltrch \fs24\sub n}{\rtlch \af15 \ltrch \fs24 \line        from S, T\line        where a}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24  = k and exists (select * from T\line                       }{\rtlch \af15 \ltrch \fs24                             where b}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24  = S.a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24  and b}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24  = c and b}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24  = S.a}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24 );
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'62\'2e\tab}}\pard \ltrpar\ql\ql\fi-74\li363\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx648{\*\pn \pnlvlbody\ilvl0\ls21\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls21\adjustright {\rtlch \af15 \ltrch \fs24 select distinct a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24 , …, a}{\rtlch \af15\sub \ltrch \fs24\sub n}{\rtlch \af15 \ltrch \fs24 \line          from S, T\line          where a}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24  = k and a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24  = b}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24  and b}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24  = c and a}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24  = b}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24 ;
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'63\'2e\tab}}\pard \ltrpar\ql\ql\fi-279\li567\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx648{\*\pn \pnlvlbody\ilvl0\ls21\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls21\adjustright {\rtlch \af15 \ltrch \fs24 No, the answers to (a) and (b) won\rquote t be correct if the \lquote distinct\rquote  keyword were rem}{\rtlch \af15 \ltrch \fs24 oved from the original query. For example, given this database:
\par }\pard \ltrpar\ql\ql\li1440\sl360\slmult1\nowidctlpar\widctlpar{\*\pn \pnlvlcont\ilvl0\ls0\pnrnot0\pndec }\adjustright {\rtlch \af15 \ltrch \fs24 S = \{ (1,1,1), (1,1,1) \}
\par }{\rtlch \af15 \ltrch \fs24 T = \{ (1,1,1), (1,1,1) \}
\par }\pard \ltrpar\ql\ql\li680\sl360\slmult1\nowidctlpar\widctlpar{\*\pn \pnlvlcont\ilvl0\ls0\pnrnot0\pndec }\adjustright {\rtlch \af15 \ltrch \fs24 \tab The original query and the answers to (a) and (b) will return \{ (1,1,1) \} but the original query without the \lquote distinct\rquote  keyword will return \{}{\rtlch \af15 \ltrch \fs24  (1,1,1), (1,1,1) \}.
\par }{\rtlch \af15 \ltrch \fs24 If we remove the \lquote distinct\rquote  keyword from (a) and (b) as well, then the answer to (a) will now be correct. This is because the statement \ldblquote find x }{\rtlch \af15 \ltrch \f69\fs24\lang1032 \'e5}{\rtlch \af15 \ltrch \fs24  Z\rdblquote  is logically equivalent to the statement \ldblquote find x such that there exists y }{\rtlch \af15 \ltrch \f69\fs24\lang1032 \'e5}{\rtlch \af15 \ltrch \fs24  Z and x=y\rdblquote }{\rtlch \af15 \ltrch \fs24 , and that is all the difference between the original query and (a). The answer to (b) would still be incorrect if we took the \lquote distinct\rquote  keyword out of it and as a proof we can look at S,T as defined above. The original query without \lquote distinct\rquote  will retu}{\rtlch \af15 \ltrch \fs24 r}{\rtlch \af15 \ltrch \fs24 n \{ (1,1,1) , (1,1,1) \} but (b) without \lquote distinct\rquote  will return\line \{ (1,1,1) , (1,1,1) , (1,1,1) , (1,1,1) \}.
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'64\'2e\tab}}\pard \ltrpar\ql\ql\fi-74\li363\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx648{\*\pn \pnlvlbody\ilvl0\ls21\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls21\adjustright {\rtlch \af15 \ltrch \fs24 Select distinct a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24 , …, a}{\rtlch \af15\sub \ltrch \fs24\sub n}{\rtlch \af15 \ltrch \fs24 \line          from S\line          where a}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24  = k and not exists (select * from T\line                                                       }{\rtlch \af15 \ltrch \fs24     where b}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24 =S.a}{\rtlch \af15\sub \ltrch \fs24\sub 1}{\rtlch \af15 \ltrch \fs24  and b}{\rtlch \af15\sub \ltrch \fs24\sub 2}{\rtlch \af15 \ltrch \fs24 =c and b}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24 =S.a}{\rtlch \af15\sub \ltrch \fs24\sub 3}{\rtlch \af15 \ltrch \fs24  );
\par {\pntext\pard\plain\ltrpar\ql\rtlch\af15\afs20\cgrid0 \ltrch\cgrid0 \'65\'2e\tab}}\pard \ltrpar\ql\ql\fi-279\li567\sl360\slmult1\nowidctlpar\widctlpar\jclisttab\tx648{\*\pn \pnlvlbody\ilvl0\ls21\pnrnot0\pnlcltr\pnstart1\pnindent648\pnhang{\pntxta .}}\ls21\adjustright {\rtlch \af15 \ltrch \fs24 It is impossible to write the 3(d) query without a subquery. We\rquote ll prove that there is no query of the allowed form that can do it. First, the selected fields must be a1, …, an because these and only these must be }{\rtlch \af15 \ltrch \fs24 the output fields. The S table must be in the \lquote from\rquote  clause, and T also has to be in the \lquote from\rquote , otherwise T can have no effect on this query (while obviously it does). Table aliases do not change the calculation itself and can therefore be ignored.\line Basic}{\rtlch \af15 \ltrch \fs24  }{\rtlch \af15 \ltrch \fs24 \rquote where\rquote  clauses cannot express the \lquote in\rquote  predicate: Comparing to a constant is obviously useless, and comparing to an attribute whose data must be in the current tuple also can\rquote t express \lquote in\rquote , since \lquote in\rquote  demands parallel comparison to data from several tup}{\rtlch \af15 \ltrch \fs24 l}{\rtlch \af15 \ltrch \fs24 es (a table), and a basic \lquote where\rquote  predicate can only use data from one (the current) tuple. Composite \lquote where\rquote  conditions cannot access data from other tuples as well, since they are just combinations of basic conditions and do not refer explicitly to data}{\rtlch \af15 \ltrch \fs24 .}{\rtlch \af15 \ltrch \fs24 
\par }}