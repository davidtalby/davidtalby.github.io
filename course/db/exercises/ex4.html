<html>

<head>
<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage Express 2.0">
<title>The Databases Course - Exercise No. 4</title>
</head>

<body>

<p align="center"><font size="4"><strong>The Databases Course</strong></font></p>

<p align="center"><font size="5"><strong>Exercise No. 4</strong></font></p>

<p align="center"><font size="4">Relational Algebra, Calculus and
QBE</font></p>

<blockquote>
    <blockquote>
        <p align="center"><font size="3">Due on January19th by
        midnight<br>
        </font></p>
    </blockquote>
</blockquote>

<ol>
    <li><font size="3">Rewrite the first six queries of exercise
        3 in the <em>domain</em> relational calculus.</font></li>
</ol>

<ol type="1" start="2">
    <li><font size="3">Express the following queries in QBE (Query
        by Example):</font></li>
</ol>

<blockquote>
    <ol type="a" start="1">
        <li><font size="3">What are the names of sites in Ukraine
            which hosted a Flamingo in a research project?</font></li>
        <li><font size="3">List the id's of whales that weigh
            more than 500 kilograms.</font></li>
    </ol>
</blockquote>

<ol type="1" start="3">
    <li><font size="3">The beer drinkers' database contains the
        following relations:<br>
        Frequents(drinker, bar) , Serves(bar, beer) , Likes(drinker,
        beer)<br>
        The first indicates the bars each drinker visits, the
        second tells what beers each bar serves, and the last
        indicates which beers each drinker lines to drink. Note
        that a drinker may not like any beer, a bar may not serve
        any beers, and so on.<br>
        Express the following queries in both relational algebra
        and the <em>safe domain</em> relational calculus:</font></li>
</ol>

<blockquote>
    <ol type="a" start="1">
        <li><font size="3">Find the drinkers that frequent only
            bars that serve some beer that they like.</font></li>
        <li><font size="3">Find the drinkers that frequent no bar
            that serves a beer that they like.</font></li>
    </ol>
</blockquote>

<ol type="1" start="5">
    <li value="4"><font size="3">Given are two relations, R(A,B,C)
        and Q(B,C)</font></li>
</ol>

<blockquote>
    <ol>
        <li type="a"><font size="3">Express their semi-join using
            tuple relational calculus.</font></li>
        <li type="a"><font size="3">Express their division using
            tuple relational calculus.</font></li>
        <li type="a"><font size="3">Assume that C is a numeric
            field. Write a tuple relational calculus query that
            takes Q as input, and returns the list of B's that
            are attached to the smallest C in the table.</font></li>
    </ol>
</blockquote>

<ol type="1" start="5">
    <li><font size="3">A calculus query is <em>domain independent</em>,
        or <em>safe</em>, if enlarging the domain from which we
        assign values to the free variables of the query, beyond
        the active domain, can never enlarge its result.</font></li>
</ol>

<blockquote>
    <ol>
        <li type="a"><font size="3">Explain why every relational
            algebra query is safe.</font></li>
        <li type="a"><font size="3">Are unsafe queries
            expressible in relational algebra?</font></li>
    </ol>
</blockquote>

<ol type="1" start="4">
    <li value="6"><font size="3">A query is called <em>monotone</em>
        if enlarging any of its input relations will not decrease
        its output relation. Prove that if an algebraic query
        does not contain non-monotonic operators (that is, minus),
        then it must be monotonic.</font></li>
</ol>

<ol type="1" start="5">
    <li value="7"><font size="3">The algebra and two calculus
        languages have equal expressive power, but SQL can do
        more. Give an example of a query that can be expressed in
        SQL but not in any of the theoretical languages.</font></li>
</ol>
</body>
</html>
